

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>5. Evaluating Learner Performance &mdash; mlr - Machine Learning in R</title>
    <link rel="stylesheet" href="../_static/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="mlr - Machine Learning in R" href="../index.html" />
    <link rel="up" title="Tutorial" href="index.html" />
    <link rel="next" title="6. Resampling" href="resample.html" />
    <link rel="prev" title="4. Predicting Outcomes for New Data" href="predict.html" /> 
  </head>
  <body>
    <div class="header-wrapper">
      <div class="header">
        <p class="logo"><a href="../index.html">
            <img class="logo" src="../_static/mlr_logo-120x64.png" alt="mlr logo"/>
        </a></p>
        <h1><a href="../index.html">mlr - Machine Learning in R</a></h1>
        <div class="rel">
          <a href="predict.html" title="4. Predicting Outcomes for New Data"
             accesskey="P">previous</a> |
          <a href="resample.html" title="6. Resampling"
             accesskey="N">next</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="evaluating-learner-performance">
<h1>5. Evaluating Learner Performance<a class="headerlink" href="#evaluating-learner-performance" title="Permalink to this headline">¶</a></h1>
<p>The quality of predictions in <strong>mlr</strong> can be assessed w.r.t. some
performance measure.</p>
<p>Typical performance measures are <strong>mean misclassification error</strong> (mmce),
<strong>accuracy</strong> (acc) or the ones based on ROC analysis for classification and <strong>mean
of squared errors</strong> (mse) or <strong>mean of absolute errors</strong> (mae) for regression.
It is also possible to access the time to train the model,
the time to compute the prediction and their sum as performance
measures.</p>
<p>To see which performance measures are implemented, have a
look at <a class="reference external" href="../_static/rdocs/mlr/measures.html">measures</a>.
In order to calculate the performance measures, the
function <a class="reference external" href="../_static/rdocs/mlr/performance.html">performance</a> is used.</p>
<div class="section" id="classification-example">
<h2>5.1. Classification example<a class="headerlink" href="#classification-example" title="Permalink to this headline">¶</a></h2>
<p>We fit a Linear Discriminant Analysis on a subset of the iris data set and calculate
the mean misclassification error (mmce) on the test data set.</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> library<span class="p">(</span><span class="s">&quot;mlr&quot;</span><span class="p">)</span>
<span class="o">&gt;</span> task <span class="o">&lt;-</span> makeClassifTask<span class="p">(</span>data <span class="o">=</span> iris<span class="p">,</span> target <span class="o">=</span> <span class="s">&quot;Species&quot;</span><span class="p">)</span>
<span class="o">&gt;</span> lrn <span class="o">&lt;-</span> makeLearner<span class="p">(</span><span class="s">&quot;classif.lda&quot;</span><span class="p">)</span>
<span class="o">&gt;</span> mod <span class="o">&lt;-</span> train<span class="p">(</span>lrn<span class="p">,</span> task <span class="o">=</span> task<span class="p">,</span> subset <span class="o">=</span> seq<span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">150</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>
<span class="o">&gt;</span> pred <span class="o">&lt;-</span> predict<span class="p">(</span>mod<span class="p">,</span> task <span class="o">=</span> task<span class="p">,</span> subset <span class="o">=</span> seq<span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">150</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>
<span class="o">&gt;</span> performance<span class="p">(</span>pred<span class="p">,</span> measure <span class="o">=</span> mmce<span class="p">)</span>
<span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="m">0.04</span>
</pre></div>
</div>
<p>Let&#8217;s have a look at some more performance measures. Note that, in order to assess
the time needed for training, the fitted model has to be passed.</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> performance<span class="p">(</span>pred<span class="p">,</span> measure <span class="o">=</span> acc<span class="p">)</span>
<span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="m">0.96</span>
<span class="o">&gt;</span> performance<span class="p">(</span>pred <span class="o">=</span> pred<span class="p">,</span> measure <span class="o">=</span> timepredict<span class="p">)</span>
<span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="m">0.005</span>
<span class="o">&gt;</span> performance<span class="p">(</span>pred <span class="o">=</span> pred<span class="p">,</span> measure <span class="o">=</span> timetrain<span class="p">,</span> model <span class="o">=</span> mod<span class="p">)</span>
<span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="m">0.013</span>
<span class="o">&gt;</span> performance<span class="p">(</span>pred <span class="o">=</span> pred<span class="p">,</span> measure <span class="o">=</span> timeboth<span class="p">,</span> model <span class="o">=</span> mod<span class="p">)</span>
<span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="m">0.018</span>
</pre></div>
</div>
<p>A nice method to calculate multiple performace measures at once makes use of the popular R funktion sapply. We define a list of measures and apply the performance function for each element.</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> ms <span class="o">&lt;-</span> list<span class="p">(</span><span class="s">&quot;mmce&quot;</span> <span class="o">=</span> mmce<span class="p">,</span> <span class="s">&quot;acc&quot;</span> <span class="o">=</span> acc<span class="p">,</span> <span class="s">&quot;timetrain&quot;</span> <span class="o">=</span> timetrain<span class="p">,</span> <span class="s">&quot;timeboth&quot;</span> <span class="o">=</span> timeboth<span class="p">)</span>
<span class="o">&gt;</span> sapply<span class="p">(</span>ms<span class="p">,</span> <span class="kr">function</span><span class="p">(</span>the.ms<span class="p">)</span> <span class="p">{</span>
<span class="o">+</span>   performance<span class="p">(</span>pred <span class="o">=</span> pred<span class="p">,</span> measure <span class="o">=</span> the.ms<span class="p">,</span> model <span class="o">=</span> mod<span class="p">)</span>
<span class="o">+</span> <span class="p">})</span>
     mmce       acc timetrain  timeboth
    <span class="m">0.040</span>     <span class="m">0.960</span>     <span class="m">0.013</span>     <span class="m">0.018</span>
</pre></div>
</div>
</div>
<div class="section" id="binary-classification">
<h2>5.2. Binary classification<a class="headerlink" href="#binary-classification" title="Permalink to this headline">¶</a></h2>
<p>In the two-class case many more measures are available. In the following example,
the accuracy, as well as the false positive and false negative rates are computed.</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> library<span class="p">(</span><span class="s">&quot;mlbench&quot;</span><span class="p">)</span>
<span class="o">&gt;</span> data<span class="p">(</span>Sonar<span class="p">)</span>
<span class="o">&gt;</span> task <span class="o">&lt;-</span> makeClassifTask<span class="p">(</span>data <span class="o">=</span> Sonar<span class="p">,</span> target <span class="o">=</span> <span class="s">&quot;Class&quot;</span><span class="p">,</span> positive <span class="o">=</span> <span class="s">&quot;M&quot;</span><span class="p">)</span>
<span class="o">&gt;</span> lrn <span class="o">&lt;-</span> makeLearner<span class="p">(</span><span class="s">&quot;classif.rpart&quot;</span><span class="p">)</span>
<span class="o">&gt;</span> mod <span class="o">&lt;-</span> train<span class="p">(</span>lrn<span class="p">,</span> task <span class="o">=</span> task<span class="p">)</span>
<span class="o">&gt;</span> pred <span class="o">&lt;-</span> predict<span class="p">(</span>mod<span class="p">,</span> task <span class="o">=</span> task<span class="p">)</span>
<span class="o">&gt;</span> performance<span class="p">(</span>pred<span class="p">,</span> measure <span class="o">=</span> acc<span class="p">)</span>
<span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="m">0.875</span>
<span class="o">&gt;</span> performance<span class="p">(</span>pred<span class="p">,</span> measure <span class="o">=</span> fpr<span class="p">)</span>
<span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="m">0.1030928</span>
<span class="o">&gt;</span> performance<span class="p">(</span>pred<span class="p">,</span> measure <span class="o">=</span> fnr<span class="p">)</span>
<span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="m">0.1441441</span>
</pre></div>
</div>
<p>Note that, in order to calculate the AUC, the area under the ROC (receiver
operating characteristic) curve, we have to make sure that posterior
probabilities are predicted, i.e. set the predict type of the <a class="reference external" href="../_static/rdocs/mlr/Learner-class.html">Learner</a> to &#8220;prob&#8221;.</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> library<span class="p">(</span><span class="s">&quot;mlbench&quot;</span><span class="p">)</span>
<span class="o">&gt;</span> data<span class="p">(</span>Sonar<span class="p">)</span>
<span class="o">&gt;</span> task <span class="o">&lt;-</span> makeClassifTask<span class="p">(</span>data <span class="o">=</span> Sonar<span class="p">,</span> target <span class="o">=</span> <span class="s">&quot;Class&quot;</span><span class="p">,</span> positive <span class="o">=</span> <span class="s">&quot;M&quot;</span><span class="p">)</span>
<span class="o">&gt;</span> lrn <span class="o">&lt;-</span> makeLearner<span class="p">(</span><span class="s">&quot;classif.rpart&quot;</span><span class="p">,</span> predict.type <span class="o">=</span> <span class="s">&quot;prob&quot;</span><span class="p">)</span>
<span class="o">&gt;</span> mod <span class="o">&lt;-</span> train<span class="p">(</span>lrn<span class="p">,</span> task <span class="o">=</span> task<span class="p">)</span>
<span class="o">&gt;</span> pred <span class="o">&lt;-</span> predict<span class="p">(</span>mod<span class="p">,</span> task <span class="o">=</span> task<span class="p">)</span>
<span class="o">&gt;</span> performance<span class="p">(</span>pred<span class="p">,</span> measure <span class="o">=</span> auc<span class="p">)</span>
<span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="m">0.9224018</span>
</pre></div>
</div>
<p>For more information on ROC analysis see section <a class="reference internal" href="roc_analysis.html"><em>ROC Analysis</em></a>.</p>
</div>
<div class="section" id="regression-example">
<h2>5.3. Regression example<a class="headerlink" href="#regression-example" title="Permalink to this headline">¶</a></h2>
<p>In regression, everything works analogous to the above examples.
We again use the BostonHousing data set, fit a Gradient Boosting Machine on a
training set and calculate the mean of squared errors and the mean of absolute
errors on the test data set.</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> library<span class="p">(</span>mlbench<span class="p">)</span>
<span class="o">&gt;</span> data<span class="p">(</span>BostonHousing<span class="p">)</span>
<span class="o">&gt;</span> task <span class="o">&lt;-</span> makeRegrTask<span class="p">(</span>data <span class="o">=</span> BostonHousing<span class="p">,</span> target <span class="o">=</span> <span class="s">&quot;medv&quot;</span><span class="p">)</span>
<span class="o">&gt;</span> <span class="c1">## Training and test set indices</span>
<span class="o">&gt;</span> training.set <span class="o">&lt;-</span> seq<span class="p">(</span>from <span class="o">=</span> <span class="m">1</span><span class="p">,</span> to <span class="o">=</span> nrow<span class="p">(</span>BostonHousing<span class="p">),</span> by <span class="o">=</span> <span class="m">2</span><span class="p">)</span>
<span class="o">&gt;</span> test.set <span class="o">&lt;-</span> seq<span class="p">(</span>from <span class="o">=</span> <span class="m">2</span><span class="p">,</span> to <span class="o">=</span> nrow<span class="p">(</span>BostonHousing<span class="p">),</span> by <span class="o">=</span> <span class="m">2</span><span class="p">)</span>
<span class="o">&gt;</span> <span class="c1">## Gradient Boosting Machine on training set</span>
<span class="o">&gt;</span> lrn <span class="o">&lt;-</span> makeLearner<span class="p">(</span><span class="s">&quot;regr.gbm&quot;</span><span class="p">,</span> n.trees <span class="o">=</span> <span class="m">1000</span><span class="p">)</span>
<span class="o">&gt;</span> mod <span class="o">&lt;-</span> train<span class="p">(</span>lrn<span class="p">,</span> task<span class="p">,</span> subset <span class="o">=</span> training.set<span class="p">)</span>
Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     <span class="m">1</span>       <span class="m">85.9615</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0954</span>
     <span class="m">2</span>       <span class="m">85.8702</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0953</span>
     <span class="m">3</span>       <span class="m">85.7779</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0809</span>
     <span class="m">4</span>       <span class="m">85.6781</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0872</span>
     <span class="m">5</span>       <span class="m">85.5880</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0671</span>
     <span class="m">6</span>       <span class="m">85.4980</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0894</span>
     <span class="m">7</span>       <span class="m">85.4059</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0774</span>
     <span class="m">8</span>       <span class="m">85.3097</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0890</span>
     <span class="m">9</span>       <span class="m">85.2183</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0712</span>
    <span class="m">10</span>       <span class="m">85.1331</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0736</span>
    <span class="m">20</span>       <span class="m">84.2892</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0770</span>
    <span class="m">40</span>       <span class="m">82.6303</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0826</span>
    <span class="m">60</span>       <span class="m">80.9704</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0864</span>
    <span class="m">80</span>       <span class="m">79.4045</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0754</span>
   <span class="m">100</span>       <span class="m">77.9030</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0577</span>
   <span class="m">120</span>       <span class="m">76.4293</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0391</span>
   <span class="m">140</span>       <span class="m">74.9743</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0391</span>
   <span class="m">160</span>       <span class="m">73.5804</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0777</span>
   <span class="m">180</span>       <span class="m">72.1769</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0614</span>
   <span class="m">200</span>       <span class="m">70.8862</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0575</span>
   <span class="m">220</span>       <span class="m">69.5895</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0692</span>
   <span class="m">240</span>       <span class="m">68.3448</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0564</span>
   <span class="m">260</span>       <span class="m">67.1260</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0363</span>
   <span class="m">280</span>       <span class="m">65.9446</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0473</span>
   <span class="m">300</span>       <span class="m">64.7523</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0616</span>
   <span class="m">320</span>       <span class="m">63.6430</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0456</span>
   <span class="m">340</span>       <span class="m">62.5320</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0495</span>
   <span class="m">360</span>       <span class="m">61.4832</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0447</span>
   <span class="m">380</span>       <span class="m">60.4551</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0409</span>
   <span class="m">400</span>       <span class="m">59.4546</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0259</span>
   <span class="m">420</span>       <span class="m">58.4749</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0432</span>
   <span class="m">440</span>       <span class="m">57.5672</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0413</span>
   <span class="m">460</span>       <span class="m">56.6567</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0379</span>
   <span class="m">480</span>       <span class="m">55.7684</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0336</span>
   <span class="m">500</span>       <span class="m">54.9110</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0327</span>
   <span class="m">520</span>       <span class="m">54.0808</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0429</span>
   <span class="m">540</span>       <span class="m">53.2488</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0312</span>
   <span class="m">560</span>       <span class="m">52.4141</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0248</span>
   <span class="m">580</span>       <span class="m">51.6104</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0261</span>
   <span class="m">600</span>       <span class="m">50.8196</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0372</span>
   <span class="m">620</span>       <span class="m">50.0838</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0279</span>
   <span class="m">640</span>       <span class="m">49.3215</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0330</span>
   <span class="m">660</span>       <span class="m">48.6011</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0343</span>
   <span class="m">680</span>       <span class="m">47.8942</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0322</span>
   <span class="m">700</span>       <span class="m">47.2071</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0317</span>
   <span class="m">720</span>       <span class="m">46.5133</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0320</span>
   <span class="m">740</span>       <span class="m">45.8245</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0229</span>
   <span class="m">760</span>       <span class="m">45.1700</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0292</span>
   <span class="m">780</span>       <span class="m">44.5349</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0230</span>
   <span class="m">800</span>       <span class="m">43.9275</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0272</span>
   <span class="m">820</span>       <span class="m">43.3214</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0290</span>
   <span class="m">840</span>       <span class="m">42.7381</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0269</span>
   <span class="m">860</span>       <span class="m">42.1644</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0245</span>
   <span class="m">880</span>       <span class="m">41.5895</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0267</span>
   <span class="m">900</span>       <span class="m">41.0493</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0235</span>
   <span class="m">920</span>       <span class="m">40.5033</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0247</span>
   <span class="m">940</span>       <span class="m">39.9663</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0249</span>
   <span class="m">960</span>       <span class="m">39.4714</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0231</span>
   <span class="m">980</span>       <span class="m">38.9783</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0227</span>
  <span class="m">1000</span>       <span class="m">38.4912</span>            <span class="o">-</span>nan     <span class="m">0.0010</span>    <span class="m">0.0232</span>
<span class="o">&gt;</span> <span class="c1">## Prediction on test set data</span>
<span class="o">&gt;</span> pred <span class="o">&lt;-</span> predict<span class="p">(</span>mod<span class="p">,</span> newdata <span class="o">=</span> BostonHousing<span class="p">[</span>test.set<span class="p">,</span> <span class="p">])</span>
<span class="o">&gt;</span> <span class="c1">## Compare predicted and true label with measure MSE</span>
<span class="o">&gt;</span> performance<span class="p">(</span>pred<span class="p">,</span> measure <span class="o">=</span> mse<span class="p">)</span>
<span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="m">42.57491</span>
</pre></div>
</div>
</div>
<div class="section" id="construction-of-additional-performance-measures">
<h2>5.4. Construction of additional performance measures<a class="headerlink" href="#construction-of-additional-performance-measures" title="Permalink to this headline">¶</a></h2>
<p>Maybe you want to evaluate a measure, which ist not yet implemented in <strong>mlr</strong>. The <a href="#id1"><span class="problematic" id="id2">makeMeasure_</span></a> function is a simple way to construct your own performance measure. Let&#8217;s implement our own version of the already mentioned mmce. For this purpose we write a simple function, that computes the measure on the basis of the predictions and subsequently wrap it in a Measure object. Then, we work with it as usual with the <a class="reference external" href="../_static/rdocs/mlr/performance.html">performance</a> function. See the R documentation of the <a href="#id3"><span class="problematic" id="id4">makeLearner_</span></a> function for details on the various parameters.</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> <span class="c1"># Define the measure.</span>
<span class="o">&gt;</span> my.mmce <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>task<span class="p">,</span> model<span class="p">,</span> pred<span class="p">,</span> extra.args<span class="p">)</span> <span class="p">{</span>
<span class="o">+</span>   tb <span class="o">&lt;-</span> table<span class="p">(</span>pred<span class="p">$</span>data<span class="p">$</span>response<span class="p">,</span> pred<span class="p">$</span>data<span class="p">$</span>truth<span class="p">)</span>
<span class="o">+</span>   <span class="m">1</span> <span class="o">-</span> sum<span class="p">(</span>diag<span class="p">(</span>tb<span class="p">))</span> <span class="o">/</span> sum<span class="p">(</span>tb<span class="p">)</span>
<span class="o">+</span> <span class="p">}</span>
<span class="o">&gt;</span> <span class="c1"># Encapsulate the function with a Measure object.</span>
<span class="o">&gt;</span> my.mmce <span class="o">&lt;-</span> makeMeasure<span class="p">(</span>id <span class="o">=</span> <span class="s">&quot;my.mmce&quot;</span><span class="p">,</span> minimize <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> classif <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span>
<span class="o">+</span>                        allowed.pred.types <span class="o">=</span> <span class="s">&quot;response&quot;</span><span class="p">,</span> fun <span class="o">=</span> my.mmce<span class="p">)</span>
<span class="o">&gt;</span> <span class="c1"># Create classification task and learner</span>
<span class="o">&gt;</span> task <span class="o">&lt;-</span> makeClassifTask<span class="p">(</span>data <span class="o">=</span> iris<span class="p">,</span> target <span class="o">=</span> <span class="s">&quot;Species&quot;</span><span class="p">)</span>
<span class="o">&gt;</span> lrn <span class="o">&lt;-</span> makeLearner<span class="p">(</span><span class="s">&quot;classif.lda&quot;</span><span class="p">)</span>
<span class="o">&gt;</span> mod <span class="o">&lt;-</span> train<span class="p">(</span>lrn<span class="p">,</span> task<span class="p">)</span>
<span class="o">&gt;</span> pred <span class="o">&lt;-</span> predict<span class="p">(</span>mod<span class="p">,</span> newdata<span class="o">=</span> iris<span class="p">)</span>
<span class="o">&gt;</span> <span class="c1"># Compare predicted and true label with our measure.</span>
<span class="o">&gt;</span> performance<span class="p">(</span>pred<span class="p">,</span> measure <span class="o">=</span> my.mmce<span class="p">)</span>
<span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="m">0.02</span>
<span class="o">&gt;</span> <span class="c1"># Apparently the result coincides with the mlr implementaion.</span>
<span class="o">&gt;</span> performance<span class="p">(</span>pred<span class="p">,</span> measure <span class="o">=</span> mmce<span class="p">)</span>
<span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="m">0.02</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
<h3>Table Of Contents</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="task.html">1. Learning Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="learner.html">2. Learners</a></li>
<li class="toctree-l2"><a class="reference internal" href="train.html">3. Training a Learner</a></li>
<li class="toctree-l2"><a class="reference internal" href="predict.html">4. Predicting Outcomes for New Data</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">5. Evaluating Learner Performance</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#classification-example">5.1. Classification example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#binary-classification">5.2. Binary classification</a></li>
<li class="toctree-l3"><a class="reference internal" href="#regression-example">5.3. Regression example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#construction-of-additional-performance-measures">5.4. Construction of additional performance measures</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="resample.html">6. Resampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="tune.html">7. Tuning Hyperparameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="variable_selection.html">8. Variable Selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="benchmark_experiments.html">9. Benchmark Experiments</a></li>
<li class="toctree-l2"><a class="reference internal" href="benchmark_analysis.html">10. Benchmark Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="roc_analysis.html">11. ROC Analysis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../integrated_learners.html">Integrated Learners</a></li>
<li class="toctree-l1"><a class="reference internal" href="../extension_points/index.html">Extension Points</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changes.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../literature.html">Relevant Literature</a></li>
</ul>

<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <a href="predict.html" title="4. Predicting Outcomes for New Data"
             >previous</a> |
          <a href="resample.html" title="6. Resampling"
             >next</a>
        </div>

        <div class="right">
          
    <div class="footer">
        &copy; Copyright 2010-2011, Bernd Bischl et.al..
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>