

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Training a learner &mdash; mlr - Machine Learning in R</title>
    <link rel="stylesheet" href="../_static/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="mlr - Machine Learning in R" href="../index.html" />
    <link rel="up" title="Tutorial" href="index.html" />
    <link rel="next" title="Predicting Outcomes for New Data" href="predict.html" />
    <link rel="prev" title="Tutorial" href="index.html" /> 
  </head>
  <body>
    <div class="header-wrapper">
      <div class="header">
        <p class="logo"><a href="../index.html">
            <img class="logo" src="../_static/mlr_logo-120x64.png" alt="mlr logo"/>
        </a></p>
        <h1><a href="../index.html">mlr - Machine Learning in R</a></h1>
        <div class="rel">
          <a href="index.html" title="Tutorial"
             accesskey="P">previous</a> |
          <a href="predict.html" title="Predicting Outcomes for New Data"
             accesskey="N">next</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="training-a-learner">
<h1>Training a learner<a class="headerlink" href="#training-a-learner" title="Permalink to this headline">¶</a></h1>
<p>&#8220;Training&#8221; a learner just means fitting a model to a given data set.
We are not concerned with the specifics of the fitting process as such
here &#8211; this will be taken care of by the underlying R methods that
this package integrates.  Rather more important is that training and
all subsequent operations can be performed by using a unified
interface.</p>
<p>This is in this case achieved by calling the function <a class="reference external" href="_static/rdocs/mlr/train.html">train</a>, passing
it a <a class="reference external" href="_static/rdocs/mlr/Learner-class.html">learner</a> and a machine learning task. The classification or
regression method is specified by its name as a string or by a
<a class="reference external" href="_static/rdocs/mlr/Learner-class.html">Learner</a> object. While the former is maybe more covenient, the latter
allows for more flexibility, for example it permits setting the
hyperparameters of the learner before training. Optionally, only a
subset of the data, specified by an index set, is used to train the
learner. This set is passed using the <tt class="docutils literal"><span class="pre">subset</span></tt> argument of <a class="reference external" href="_static/rdocs/mlr/train.html">train</a>.</p>
<p>The return value is always an object of class <a class="reference external" href="_static/rdocs/mlr/Model-class.html">Model</a> which wraps the
concrete model of the used R classification or regression method. It
can subsequently be used to perform a <a class="reference external" href="_static/rdocs/mlr/train.html">prediction</a> for new
observations.</p>
<blockquote>
<div><img alt="Flow chart of the mlr processing pipeline" class="align-middle" src="../_images/train-basic_processing4.png" style="width: 700px;" /></div></blockquote>
<div class="section" id="classification-example">
<h2>Classification example<a class="headerlink" href="#classification-example" title="Permalink to this headline">¶</a></h2>
<p>Let&#8217;s have a look at the iris data set.</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> library<span class="p">(</span><span class="s">&quot;mlr&quot;</span><span class="p">)</span>
<span class="o">&gt;</span> ct <span class="o">&lt;-</span> makeClassifTask<span class="p">(</span>data <span class="o">=</span> iris<span class="p">,</span> target <span class="o">=</span> <span class="s">&quot;Species&quot;</span><span class="p">)</span>
<span class="o">&gt;</span> m <span class="o">&lt;-</span> train<span class="p">(</span><span class="s">&quot;classif.rpart&quot;</span><span class="p">,</span> ct<span class="p">)</span>
<span class="o">&gt;</span> m <span class="o">&lt;-</span> train<span class="p">(</span><span class="s">&quot;classif.rpart&quot;</span><span class="p">,</span> ct<span class="p">,</span> subset <span class="o">=</span> seq<span class="p">(</span>from <span class="o">=</span> <span class="m">1</span><span class="p">,</span> to <span class="o">=</span> <span class="m">150</span><span class="p">,</span>
<span class="o">+</span>     by <span class="o">=</span> <span class="m">2</span><span class="p">))</span>
<span class="o">&gt;</span> l <span class="o">&lt;-</span> makeLearner<span class="p">(</span><span class="s">&quot;classif.rpart&quot;</span><span class="p">,</span> minsplit <span class="o">=</span> <span class="m">7</span><span class="p">,</span> cp <span class="o">=</span> <span class="m">0.03</span><span class="p">)</span>
<span class="o">&gt;</span> m <span class="o">&lt;-</span> train<span class="p">(</span>l<span class="p">,</span> ct<span class="p">,</span> subset <span class="o">=</span> seq<span class="p">(</span>from <span class="o">=</span> <span class="m">1</span><span class="p">,</span> to <span class="o">=</span> <span class="m">150</span><span class="p">,</span> by <span class="o">=</span> <span class="m">2</span><span class="p">))</span>
<span class="o">&gt;</span> m
Learner model for id<span class="o">=</span>classif.rpart class<span class="o">=</span>classif.rpart
Trained on obs: <span class="m">75</span>
Used features: <span class="m">4</span>
Hyperparameters: minsplit<span class="o">=</span><span class="m">7</span><span class="p">,</span>cp<span class="o">=</span><span class="m">0.03</span>
<span class="o">&gt;</span> l<span class="p">@</span>par.vals
<span class="p">$</span>minsplit
<span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="m">7</span>

<span class="p">$</span>cp
<span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="m">0.03</span>
<span class="o">&gt;</span> m<span class="p">@</span>learner<span class="p">@</span>par.vals
<span class="p">$</span>minsplit
<span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="m">7</span>

<span class="p">$</span>cp
<span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="m">0.03</span>
<span class="o">&gt;</span> m<span class="p">@</span>subset
 <span class="p">[</span><span class="m">1</span><span class="p">]</span>   <span class="m">1</span>   <span class="m">3</span>   <span class="m">5</span>   <span class="m">7</span>   <span class="m">9</span>  <span class="m">11</span>  <span class="m">13</span>  <span class="m">15</span>  <span class="m">17</span>  <span class="m">19</span>  <span class="m">21</span>  <span class="m">23</span>  <span class="m">25</span>  <span class="m">27</span>  <span class="m">29</span>  <span class="m">31</span>  <span class="m">33</span>  <span class="m">35</span>  <span class="m">37</span>
<span class="p">[</span><span class="m">20</span><span class="p">]</span>  <span class="m">39</span>  <span class="m">41</span>  <span class="m">43</span>  <span class="m">45</span>  <span class="m">47</span>  <span class="m">49</span>  <span class="m">51</span>  <span class="m">53</span>  <span class="m">55</span>  <span class="m">57</span>  <span class="m">59</span>  <span class="m">61</span>  <span class="m">63</span>  <span class="m">65</span>  <span class="m">67</span>  <span class="m">69</span>  <span class="m">71</span>  <span class="m">73</span>  <span class="m">75</span>
<span class="p">[</span><span class="m">39</span><span class="p">]</span>  <span class="m">77</span>  <span class="m">79</span>  <span class="m">81</span>  <span class="m">83</span>  <span class="m">85</span>  <span class="m">87</span>  <span class="m">89</span>  <span class="m">91</span>  <span class="m">93</span>  <span class="m">95</span>  <span class="m">97</span>  <span class="m">99</span> <span class="m">101</span> <span class="m">103</span> <span class="m">105</span> <span class="m">107</span> <span class="m">109</span> <span class="m">111</span> <span class="m">113</span>
<span class="p">[</span><span class="m">58</span><span class="p">]</span> <span class="m">115</span> <span class="m">117</span> <span class="m">119</span> <span class="m">121</span> <span class="m">123</span> <span class="m">125</span> <span class="m">127</span> <span class="m">129</span> <span class="m">131</span> <span class="m">133</span> <span class="m">135</span> <span class="m">137</span> <span class="m">139</span> <span class="m">141</span> <span class="m">143</span> <span class="m">145</span> <span class="m">147</span> <span class="m">149</span>
<span class="o">&gt;</span> m<span class="p">@</span>learner.model
n<span class="o">=</span> <span class="m">75</span>

node<span class="p">),</span> split<span class="p">,</span> n<span class="p">,</span> loss<span class="p">,</span> yval<span class="p">,</span> <span class="p">(</span>yprob<span class="p">)</span>
      <span class="o">*</span> denotes terminal node

<span class="m">1</span><span class="p">)</span> root <span class="m">75</span> <span class="m">50</span> setosa <span class="p">(</span><span class="m">0.3333333</span> <span class="m">0.3333333</span> <span class="m">0.3333333</span><span class="p">)</span>
  <span class="m">2</span><span class="p">)</span> Petal.Length<span class="o">&lt;</span> <span class="m">2.45</span> <span class="m">25</span>  <span class="m">0</span> setosa <span class="p">(</span><span class="m">1.0000000</span> <span class="m">0.0000000</span> <span class="m">0.0000000</span><span class="p">)</span> <span class="o">*</span>
  <span class="m">3</span><span class="p">)</span> Petal.Length<span class="o">&gt;=</span><span class="m">2.45</span> <span class="m">50</span> <span class="m">25</span> versicolor <span class="p">(</span><span class="m">0.0000000</span> <span class="m">0.5000000</span> <span class="m">0.5000000</span><span class="p">)</span>
    <span class="m">6</span><span class="p">)</span> Petal.Width<span class="o">&lt;</span> <span class="m">1.65</span> <span class="m">25</span>  <span class="m">1</span> versicolor <span class="p">(</span><span class="m">0.0000000</span> <span class="m">0.9600000</span> <span class="m">0.0400000</span><span class="p">)</span> <span class="o">*</span>
    <span class="m">7</span><span class="p">)</span> Petal.Width<span class="o">&gt;=</span><span class="m">1.65</span> <span class="m">25</span>  <span class="m">1</span> virginica <span class="p">(</span><span class="m">0.0000000</span> <span class="m">0.0400000</span> <span class="m">0.9600000</span><span class="p">)</span> <span class="o">*</span>
</pre></div>
</div>
<div class="section" id="regression-example">
<h3>Regression example<a class="headerlink" href="#regression-example" title="Permalink to this headline">¶</a></h3>
<p>As regression example we use the BostonHousing data set.</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> library<span class="p">(</span><span class="s">&quot;mlbench&quot;</span><span class="p">)</span>
<span class="o">&gt;</span> data<span class="p">(</span>BostonHousing<span class="p">)</span>
<span class="o">&gt;</span> rt <span class="o">&lt;-</span> makeRegrTask<span class="p">(</span>data <span class="o">=</span> BostonHousing<span class="p">,</span> target <span class="o">=</span> <span class="s">&quot;medv&quot;</span><span class="p">)</span>
<span class="o">&gt;</span> m <span class="o">&lt;-</span> train<span class="p">(</span><span class="s">&quot;regr.gbm&quot;</span><span class="p">,</span> rt<span class="p">)</span>
Loaded gbm <span class="m">1.6</span><span class="o">-</span><span class="m">3.1</span>
<span class="o">&gt;</span> m <span class="o">&lt;-</span> train<span class="p">(</span><span class="s">&quot;regr.gbm&quot;</span><span class="p">,</span> rt<span class="p">,</span> subset <span class="o">=</span> seq<span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">506</span><span class="p">,</span> <span class="m">2</span><span class="p">))</span>
<span class="o">&gt;</span> l <span class="o">&lt;-</span> makeLearner<span class="p">(</span><span class="s">&quot;regr.gbm&quot;</span><span class="p">,</span> n.trees <span class="o">=</span> <span class="m">500</span><span class="p">,</span> distribution <span class="o">=</span> <span class="s">&quot;laplace&quot;</span><span class="p">,</span>
<span class="o">+</span>     interaction.depth <span class="o">=</span> <span class="m">3</span><span class="p">)</span>
<span class="o">&gt;</span> m <span class="o">&lt;-</span> train<span class="p">(</span>l<span class="p">,</span> rt<span class="p">,</span> subset <span class="o">=</span> seq<span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">506</span><span class="p">,</span> <span class="m">2</span><span class="p">))</span>
<span class="o">&gt;</span> m
Learner model for id<span class="o">=</span>regr.gbm class<span class="o">=</span>regr.gbm
Trained on obs: <span class="m">253</span>
Used features: <span class="m">13</span>
Hyperparameters: distribution<span class="o">=</span>laplace<span class="p">,</span>n.trees<span class="o">=</span><span class="m">500</span><span class="p">,</span>interaction.depth<span class="o">=</span><span class="m">3</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
<h3>Table Of Contents</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorial</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="">Training a learner</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#classification-example">Classification example</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#regression-example">Regression example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="predict.html">Predicting Outcomes for New Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="resample.html">Resampling Learners</a></li>
<li class="toctree-l2"><a class="reference internal" href="performance.html">Evaluateing Learner Performance</a></li>
<li class="toctree-l2"><a class="reference internal" href="tune.html">Tuning hyperparamaters</a></li>
<li class="toctree-l2"><a class="reference internal" href="learner.html">Integrated learners</a></li>
<li class="toctree-l2"><a class="reference internal" href="variable_selection.html">Variable Selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="benchmark_experiments.html">Benchmark Experiments</a></li>
<li class="toctree-l2"><a class="reference internal" href="benchmark_analysis.html">Benchmark Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="roc_analysis.html">ROC Analysis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../concept/index.html">Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../howto/index.html">How-Tos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../integrated_learners.html">Integrated Learners</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changes.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../literature.html">Relevant Literature</a></li>
</ul>

<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <a href="index.html" title="Tutorial"
             >previous</a> |
          <a href="predict.html" title="Predicting Outcomes for New Data"
             >next</a>
        </div>

        <div class="right">
          
    <div class="footer">
        &copy; Copyright 2010-2011, Bernd Bischl et.al..
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>