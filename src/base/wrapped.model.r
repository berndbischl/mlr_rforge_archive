#' @include task.learn.r
roxygen()


#' A classifier model is generated by \code{\link{train}}. It consists of the learn.task,
#' the classification model, the used hyperparameters and a vector specifying the cases of the training sample. 
#' 
#' @slot task.class String 
#' @slot learner.class Specifies learner class
#' @slot learner.name Name of the learning method
#' @slot learner.model External model from existing R packages like lda, rpart, etc
#' @slot subset An index vector specifying the cases of the training sample that were used for the model. 
#' @slot vars Vector specifying the variables which were used to build the model. 
#' @slot parset Contains the hyperparameters of the train function. If empty no parameters were used.
#' 
#' @examples  see \link{train}
#' 
#' @title wrapped.model
#' @importFrom stats predict
 
setClass(
		"wrapped.model",
		representation = representation(
				task.class = "character",
				learner.class = "character",
				learner.name = "character",
				learner.model = "ANY",
				subset = "numeric",
				vars = "character",
				parset = "list"
		)
)

setClass(
		"wrapped.classif.model",
		contains = c("wrapped.model")
)

setClass(
		"wrapped.regr.model",
		contains = c("wrapped.model")
)



#---------------- predict --------------------------------------------



#' Conversion to string.
setMethod(
		f = "as.character",
		signature = signature("wrapped.model"),
		def = function(x) {
			ps <- paste(names(x@parset), x@parset, sep="=", collapse=" ")
			return(
					paste(
							"Learner model for ", x@learner.name, "\n",  
							"Hyperparameters: ", ps, "\n",
							"Trained on obs: ", length(x@subset), "\n",
							sep=""
					)
			)
		}
)

#' Prints the object by calling as.character.
setMethod(
		f = "print",
		signature = signature("wrapped.model"),
		def = function(x, ...) {
			cat(as.character(x))
		}
)

#' Shows the object by calling as.character.
setMethod(
		f = "show",
		signature = signature("wrapped.model"),
		def = function(object) {
			cat(as.character(object))
		}
)


#' Getter.
#' @param x wrapped.model object
#' @param i [\code{\link{character}}]
#' \describe{
#'	 \item{task.class}{Learning task class}
#' 	 \item{learner.class}{Learner class}
#' 	 \item{learner.name}{Name of the learning method}
#' 	 \item{vars}{Variables used to build the model.} 
#'   \item{subset}{Indices of used training cases in fit.}
#'   \item{parset}{Selected hyperparameters for model.}
#'   \item{learner.model}{External model from existing R packages like lda, rpart, etc.}
#' }
#' 
#' @rdname getter,wrapped.model-method
#' @aliases wrapped.model.getter getter,wrapped.model-method
#' @title Getter for wrapped.model

setMethod(
		f = "[",
		signature = signature("wrapped.model"),
		def = function(x,i,j,...,drop) {
			return(
					eval(substitute("@"(x, slot), list(slot=i)))
			)
		}
)











